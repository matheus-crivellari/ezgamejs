<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <script src="../src/game.class.js"></script>
    <script src="../src/gameObject.class.js"></script>
    <script src="../src/ezgame.js"></script>
    <script src="../src/debug.class.js"></script>

    <title>EzGameJS</title>
</head>
<body>
    <h1 style="margin-bottom: 0">
        EzGameJS
    </h1>
    <p style="margin-top: 0"><small>Web Game development made simple.</small></p>

    <h2>Breakout example (debug render)</h2>

    <canvas id="display"></canvas>
    <script>
        const display = document.querySelector('#display');
        const breakout = new Game(display);
        breakout.scale(640, 480);

        const padw = 30, padh = 10;
        const pad = new GameObject('pad', padw, padh,
            breakout.width / 2 - padw / 2,
            breakout.height - padh * 2,
            'red'
        );

        pad.input = ($this, $game) => {
            const elem = $game.domElement;

            elem.addEventListener('mousemove', (e) => {
                const r = $game.ratio;
                let x = (e.clientX - elem.offsetLeft) / r,
                    y = (e.clientY - elem.offsetTop) / r;

                $this.x = x;
            });
        };

        pad.update = ($this, $game) => {
            if($this.x < $this.width / 2)
                $this.x = $this.width / 2;

            if($this.x > $game.width - $this.width / 2)
                $this.x = $game.width - $this.width / 2;
        }

        pad.render = ($this, display) => {
            Debug.render($this, display, $this.color);
        };

        let bricks = [], brickOffset = 10, gap = 5, x = 0, y = 0;

        for (let i = 0; i < 36; i++) {
            if (i % 9 === 0 && i) {
                x = 0; y++;
            }

            const brick = new GameObject('brick', padw, padh);
            brick.color = 'green';

            brick.x = (brickOffset * 2) + (x * padw) + (x * gap);
            brick.y = brickOffset + (y * padh) + (y * gap);

            brick.render = ($this, display) => {
                Debug.render($this, display, $this.color);
            };

            bricks = [...bricks, brick];
            x++;
        }

        breakout.add(pad);
        breakout.add(bricks);

        EzGame.start(breakout);
    </script>
</body>
</html>